<!DOCTYPE html>
<html>
<head>
    <title>MCQ Quiz</title>
    <style>
        button { display:block; margin:10px; padding:10px }
        .correct { background:green; color:white }
        .wrong { background:red; color:white }
    </style>
</head>
<body>

<h3 id="qno"></h3>
<h2 id="question"></h2>
<div id="options"></div>

<script>
let current = 0;

function loadQuestion(){
    fetch("/next", {method:"POST"})
    .then(res=>res.json())
    .then(data=>{
        if(data.done){
            fetch("/result").then(r=>r.json()).then(r=>{
                document.body.innerHTML = `
                <h2>Result</h2>
                <p>Total: ${r.total}</p>
                <p>Correct: ${r.correct}</p>
                <p>Wrong: ${r.wrong}</p>
                <p>Accuracy: ${r.accuracy}%</p>
                `;
            })
            return;
        }
        document.getElementById("qno").innerText =
            `Question ${data.index+1} / ${data.total}`;
        document.getElementById("question").innerText = data.question;

        let div = document.getElementById("options");
        div.innerHTML = "";
        ["a","b","c","d"].forEach((o,i)=>{
            let btn = document.createElement("button");
            btn.innerText = data.options[i];
            btn.onclick = ()=>check(o,btn);
            div.appendChild(btn);
        });
    })
}

function check(opt,btn){
    fetch("/check",{
        method:"POST",
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({selected:opt})
    }).then(res=>res.json()).then(r=>{
        if(r.correct){
            btn.classList.add("correct");
        }else{
            btn.classList.add("wrong");
        }
        setTimeout(loadQuestion,800);
    })
}

loadQuestion();
</script>

</body>
</html>
