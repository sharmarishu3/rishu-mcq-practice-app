<!DOCTYPE html>
<html>
<head>
    <title>MCQ Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        .box {
            max-width: 600px;
            margin: 50px auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
        }
        .option {
            padding: 10px;
            margin: 8px 0;
            background: #eee;
            cursor: pointer;
            border-radius: 5px;
        }
        .correct { background: lightgreen; }
        .wrong { background: #ffb3b3; }
        button {
            width: 100%;
            padding: 10px;
            margin-top: 15px;
        }
    </style>
</head>
<body>

<div class="box">
    <h3 id="qno"></h3>
    <h2 id="question"></h2>

    <div id="options"></div>

    <button onclick="nextQuestion()">Next</button>
    <h3 id="result"></h3>
</div>

<script>
let questions = {{ questions | tojson }};
let index = 0;
let score = 0;

function loadQuestion() {
    document.getElementById("result").innerText = "";
    let q = questions[index];
    document.getElementById("qno").innerText =
        "Question " + (index + 1) + " / " + questions.length;
    document.getElementById("question").innerText = q.question;

    let optionsBox = document.getElementById("options");
    optionsBox.innerHTML = "";

    q.options.forEach(opt => {
        let div = document.createElement("div");
        div.className = "option";
        div.innerText = opt;
        div.onclick = () => checkAnswer(div, q.answer);
        optionsBox.appendChild(div);
    });
}

function checkAnswer(selected, correct) {
    let opts = document.getElementsByClassName("option");
    for (let o of opts) o.onclick = null;

    if (selected.innerText === correct) {
        selected.classList.add("correct");
        score++;
    } else {
        selected.classList.add("wrong");
        for (let o of opts) {
            if (o.innerText === correct) o.classList.add("correct");
        }
    }
}

function nextQuestion() {
    index++;
    if (index < questions.length) {
        loadQuestion();
    } else {
        document.querySelector(".box").innerHTML =
            "<h2>Test Finished</h2>" +
            "<h3>Score: " + score + " / " + questions.length + "</h3>" +
            "<button onclick='location.reload()'>Restart</button>";
    }
}

loadQuestion();
</script>

</body>
</html>
